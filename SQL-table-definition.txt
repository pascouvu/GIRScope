| table_schema | table_name        | ddl_text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------------ | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| auth         | audit_log_entries | -- ------------------------------------------------------------
-- DDL summary for auth.audit_log_entries
-- ------------------------------------------------------------

Columns:
  instance_id uuid NULL
  id uuid NOT NULL
  payload json NULL
  created_at timestamp with time zone NULL
  ip_address character varying(64) NOT NULL DEFAULT ''::character varying

Constraints:
  PRIMARY KEY audit_log_entries_pkey : PRIMARY KEY (id)

Indexes:
  audit_log_entries_pkey : CREATE UNIQUE INDEX audit_log_entries_pkey ON auth.audit_log_entries USING btree (id)
  audit_logs_instance_id_idx : CREATE INDEX audit_logs_instance_id_idx ON auth.audit_log_entries USING btree (instance_id)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| auth         | flow_state        | -- ------------------------------------------------------------
-- DDL summary for auth.flow_state
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  user_id uuid NULL
  auth_code text NOT NULL
  code_challenge_method USER-DEFINED NOT NULL
  code_challenge text NOT NULL
  provider_type text NOT NULL
  provider_access_token text NULL
  provider_refresh_token text NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  authentication_method text NOT NULL
  auth_code_issued_at timestamp with time zone NULL

Constraints:
  PRIMARY KEY flow_state_pkey : PRIMARY KEY (id)

Indexes:
  flow_state_pkey : CREATE UNIQUE INDEX flow_state_pkey ON auth.flow_state USING btree (id)
  idx_auth_code : CREATE INDEX idx_auth_code ON auth.flow_state USING btree (auth_code)
  idx_user_id_auth_method : CREATE INDEX idx_user_id_auth_method ON auth.flow_state USING btree (user_id, authentication_method)
  flow_state_created_at_idx : CREATE INDEX flow_state_created_at_idx ON auth.flow_state USING btree (created_at DESC)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| auth         | identities        | -- ------------------------------------------------------------
-- DDL summary for auth.identities
-- ------------------------------------------------------------

Columns:
  provider_id text NOT NULL
  user_id uuid NOT NULL
  identity_data jsonb NOT NULL
  provider text NOT NULL
  last_sign_in_at timestamp with time zone NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  email text NULL
  id uuid NOT NULL DEFAULT gen_random_uuid()

Constraints:
  PRIMARY KEY identities_pkey : PRIMARY KEY (id)
  UNIQUE identities_provider_id_provider_unique : UNIQUE (provider_id, provider)
  FOREIGN KEY identities_user_id_fkey : FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE

Indexes:
  identities_user_id_idx : CREATE INDEX identities_user_id_idx ON auth.identities USING btree (user_id)
  identities_email_idx : CREATE INDEX identities_email_idx ON auth.identities USING btree (email text_pattern_ops)
  identities_pkey : CREATE UNIQUE INDEX identities_pkey ON auth.identities USING btree (id)
  identities_provider_id_provider_unique : CREATE UNIQUE INDEX identities_provider_id_provider_unique ON auth.identities USING btree (provider_id, provider)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| auth         | instances         | -- ------------------------------------------------------------
-- DDL summary for auth.instances
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  uuid uuid NULL
  raw_base_config text NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL

Constraints:
  PRIMARY KEY instances_pkey : PRIMARY KEY (id)

Indexes:
  instances_pkey : CREATE UNIQUE INDEX instances_pkey ON auth.instances USING btree (id)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| auth         | mfa_amr_claims    | -- ------------------------------------------------------------
-- DDL summary for auth.mfa_amr_claims
-- ------------------------------------------------------------

Columns:
  session_id uuid NOT NULL
  created_at timestamp with time zone NOT NULL
  updated_at timestamp with time zone NOT NULL
  authentication_method text NOT NULL
  id uuid NOT NULL

Constraints:
  PRIMARY KEY amr_id_pk : PRIMARY KEY (id)
  UNIQUE mfa_amr_claims_session_id_authentication_method_pkey : UNIQUE (session_id, authentication_method)
  FOREIGN KEY mfa_amr_claims_session_id_fkey : FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE

Indexes:
  mfa_amr_claims_session_id_authentication_method_pkey : CREATE UNIQUE INDEX mfa_amr_claims_session_id_authentication_method_pkey ON auth.mfa_amr_claims USING btree (session_id, authentication_method)
  amr_id_pk : CREATE UNIQUE INDEX amr_id_pk ON auth.mfa_amr_claims USING btree (id)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| auth         | mfa_challenges    | -- ------------------------------------------------------------
-- DDL summary for auth.mfa_challenges
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  factor_id uuid NOT NULL
  created_at timestamp with time zone NOT NULL
  verified_at timestamp with time zone NULL
  ip_address inet NOT NULL
  otp_code text NULL
  web_authn_session_data jsonb NULL

Constraints:
  FOREIGN KEY mfa_challenges_auth_factor_id_fkey : FOREIGN KEY (factor_id) REFERENCES auth.mfa_factors(id) ON DELETE CASCADE
  PRIMARY KEY mfa_challenges_pkey : PRIMARY KEY (id)

Indexes:
  mfa_challenges_pkey : CREATE UNIQUE INDEX mfa_challenges_pkey ON auth.mfa_challenges USING btree (id)
  mfa_challenge_created_at_idx : CREATE INDEX mfa_challenge_created_at_idx ON auth.mfa_challenges USING btree (created_at DESC)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| auth         | mfa_factors       | -- ------------------------------------------------------------
-- DDL summary for auth.mfa_factors
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  user_id uuid NOT NULL
  friendly_name text NULL
  factor_type USER-DEFINED NOT NULL
  status USER-DEFINED NOT NULL
  created_at timestamp with time zone NOT NULL
  updated_at timestamp with time zone NOT NULL
  secret text NULL
  phone text NULL
  last_challenged_at timestamp with time zone NULL
  web_authn_credential jsonb NULL
  web_authn_aaguid uuid NULL

Constraints:
  UNIQUE mfa_factors_last_challenged_at_key : UNIQUE (last_challenged_at)
  PRIMARY KEY mfa_factors_pkey : PRIMARY KEY (id)
  FOREIGN KEY mfa_factors_user_id_fkey : FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE

Indexes:
  mfa_factors_pkey : CREATE UNIQUE INDEX mfa_factors_pkey ON auth.mfa_factors USING btree (id)
  mfa_factors_user_friendly_name_unique : CREATE UNIQUE INDEX mfa_factors_user_friendly_name_unique ON auth.mfa_factors USING btree (friendly_name, user_id) WHERE (TRIM(BOTH FROM friendly_name) <> ''::text)
  factor_id_created_at_idx : CREATE INDEX factor_id_created_at_idx ON auth.mfa_factors USING btree (user_id, created_at)
  mfa_factors_user_id_idx : CREATE INDEX mfa_factors_user_id_idx ON auth.mfa_factors USING btree (user_id)
  unique_phone_factor_per_user : CREATE UNIQUE INDEX unique_phone_factor_per_user ON auth.mfa_factors USING btree (user_id, phone)
  mfa_factors_last_challenged_at_key : CREATE UNIQUE INDEX mfa_factors_last_challenged_at_key ON auth.mfa_factors USING btree (last_challenged_at)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| auth         | one_time_tokens   | -- ------------------------------------------------------------
-- DDL summary for auth.one_time_tokens
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  user_id uuid NOT NULL
  token_type USER-DEFINED NOT NULL
  token_hash text NOT NULL
  relates_to text NOT NULL
  created_at timestamp without time zone NOT NULL DEFAULT now()
  updated_at timestamp without time zone NOT NULL DEFAULT now()

Constraints:
  PRIMARY KEY one_time_tokens_pkey : PRIMARY KEY (id)
  CHECK one_time_tokens_token_hash_check : CHECK ((char_length(token_hash) > 0))
  FOREIGN KEY one_time_tokens_user_id_fkey : FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE

Indexes:
  one_time_tokens_pkey : CREATE UNIQUE INDEX one_time_tokens_pkey ON auth.one_time_tokens USING btree (id)
  one_time_tokens_token_hash_hash_idx : CREATE INDEX one_time_tokens_token_hash_hash_idx ON auth.one_time_tokens USING hash (token_hash)
  one_time_tokens_relates_to_hash_idx : CREATE INDEX one_time_tokens_relates_to_hash_idx ON auth.one_time_tokens USING hash (relates_to)
  one_time_tokens_user_id_token_type_key : CREATE UNIQUE INDEX one_time_tokens_user_id_token_type_key ON auth.one_time_tokens USING btree (user_id, token_type)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| auth         | refresh_tokens    | -- ------------------------------------------------------------
-- DDL summary for auth.refresh_tokens
-- ------------------------------------------------------------

Columns:
  instance_id uuid NULL
  id bigint NOT NULL DEFAULT nextval('auth.refresh_tokens_id_seq'::regclass)
  token character varying(255) NULL
  user_id character varying(255) NULL
  revoked boolean NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  parent character varying(255) NULL
  session_id uuid NULL

Constraints:
  PRIMARY KEY refresh_tokens_pkey : PRIMARY KEY (id)
  FOREIGN KEY refresh_tokens_session_id_fkey : FOREIGN KEY (session_id) REFERENCES auth.sessions(id) ON DELETE CASCADE
  UNIQUE refresh_tokens_token_unique : UNIQUE (token)

Indexes:
  refresh_tokens_pkey : CREATE UNIQUE INDEX refresh_tokens_pkey ON auth.refresh_tokens USING btree (id)
  refresh_tokens_instance_id_idx : CREATE INDEX refresh_tokens_instance_id_idx ON auth.refresh_tokens USING btree (instance_id)
  refresh_tokens_instance_id_user_id_idx : CREATE INDEX refresh_tokens_instance_id_user_id_idx ON auth.refresh_tokens USING btree (instance_id, user_id)
  refresh_tokens_token_unique : CREATE UNIQUE INDEX refresh_tokens_token_unique ON auth.refresh_tokens USING btree (token)
  refresh_tokens_parent_idx : CREATE INDEX refresh_tokens_parent_idx ON auth.refresh_tokens USING btree (parent)
  refresh_tokens_session_id_revoked_idx : CREATE INDEX refresh_tokens_session_id_revoked_idx ON auth.refresh_tokens USING btree (session_id, revoked)
  refresh_tokens_updated_at_idx : CREATE INDEX refresh_tokens_updated_at_idx ON auth.refresh_tokens USING btree (updated_at DESC)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| auth         | saml_providers    | -- ------------------------------------------------------------
-- DDL summary for auth.saml_providers
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  sso_provider_id uuid NOT NULL
  entity_id text NOT NULL
  metadata_xml text NOT NULL
  metadata_url text NULL
  attribute_mapping jsonb NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  name_id_format text NULL

Constraints:
  CHECK entity_id not empty : CHECK ((char_length(entity_id) > 0))
  CHECK metadata_url not empty : CHECK (((metadata_url = NULL::text) OR (char_length(metadata_url) > 0)))
  CHECK metadata_xml not empty : CHECK ((char_length(metadata_xml) > 0))
  UNIQUE saml_providers_entity_id_key : UNIQUE (entity_id)
  PRIMARY KEY saml_providers_pkey : PRIMARY KEY (id)
  FOREIGN KEY saml_providers_sso_provider_id_fkey : FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE

Indexes:
  saml_providers_pkey : CREATE UNIQUE INDEX saml_providers_pkey ON auth.saml_providers USING btree (id)
  saml_providers_entity_id_key : CREATE UNIQUE INDEX saml_providers_entity_id_key ON auth.saml_providers USING btree (entity_id)
  saml_providers_sso_provider_id_idx : CREATE INDEX saml_providers_sso_provider_id_idx ON auth.saml_providers USING btree (sso_provider_id)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| auth         | saml_relay_states | -- ------------------------------------------------------------
-- DDL summary for auth.saml_relay_states
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  sso_provider_id uuid NOT NULL
  request_id text NOT NULL
  for_email text NULL
  redirect_to text NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  flow_state_id uuid NULL

Constraints:
  CHECK request_id not empty : CHECK ((char_length(request_id) > 0))
  FOREIGN KEY saml_relay_states_flow_state_id_fkey : FOREIGN KEY (flow_state_id) REFERENCES auth.flow_state(id) ON DELETE CASCADE
  PRIMARY KEY saml_relay_states_pkey : PRIMARY KEY (id)
  FOREIGN KEY saml_relay_states_sso_provider_id_fkey : FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE

Indexes:
  saml_relay_states_pkey : CREATE UNIQUE INDEX saml_relay_states_pkey ON auth.saml_relay_states USING btree (id)
  saml_relay_states_sso_provider_id_idx : CREATE INDEX saml_relay_states_sso_provider_id_idx ON auth.saml_relay_states USING btree (sso_provider_id)
  saml_relay_states_for_email_idx : CREATE INDEX saml_relay_states_for_email_idx ON auth.saml_relay_states USING btree (for_email)
  saml_relay_states_created_at_idx : CREATE INDEX saml_relay_states_created_at_idx ON auth.saml_relay_states USING btree (created_at DESC)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| auth         | schema_migrations | -- ------------------------------------------------------------
-- DDL summary for auth.schema_migrations
-- ------------------------------------------------------------

Columns:
  version character varying(255) NOT NULL

Constraints:
  (no constraints)

Indexes:
  schema_migrations_pkey : CREATE UNIQUE INDEX schema_migrations_pkey ON auth.schema_migrations USING btree (version)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| auth         | sessions          | -- ------------------------------------------------------------
-- DDL summary for auth.sessions
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  user_id uuid NOT NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  factor_id uuid NULL
  aal USER-DEFINED NULL
  not_after timestamp with time zone NULL
  refreshed_at timestamp without time zone NULL
  user_agent text NULL
  ip inet NULL
  tag text NULL

Constraints:
  PRIMARY KEY sessions_pkey : PRIMARY KEY (id)
  FOREIGN KEY sessions_user_id_fkey : FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE

Indexes:
  sessions_pkey : CREATE UNIQUE INDEX sessions_pkey ON auth.sessions USING btree (id)
  user_id_created_at_idx : CREATE INDEX user_id_created_at_idx ON auth.sessions USING btree (user_id, created_at)
  sessions_user_id_idx : CREATE INDEX sessions_user_id_idx ON auth.sessions USING btree (user_id)
  sessions_not_after_idx : CREATE INDEX sessions_not_after_idx ON auth.sessions USING btree (not_after DESC)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| auth         | sso_domains       | -- ------------------------------------------------------------
-- DDL summary for auth.sso_domains
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  sso_provider_id uuid NOT NULL
  domain text NOT NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL

Constraints:
  CHECK domain not empty : CHECK ((char_length(domain) > 0))
  PRIMARY KEY sso_domains_pkey : PRIMARY KEY (id)
  FOREIGN KEY sso_domains_sso_provider_id_fkey : FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers(id) ON DELETE CASCADE

Indexes:
  sso_domains_pkey : CREATE UNIQUE INDEX sso_domains_pkey ON auth.sso_domains USING btree (id)
  sso_domains_sso_provider_id_idx : CREATE INDEX sso_domains_sso_provider_id_idx ON auth.sso_domains USING btree (sso_provider_id)
  sso_domains_domain_idx : CREATE UNIQUE INDEX sso_domains_domain_idx ON auth.sso_domains USING btree (lower(domain))

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| auth         | sso_providers     | -- ------------------------------------------------------------
-- DDL summary for auth.sso_providers
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  resource_id text NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  disabled boolean NULL

Constraints:
  CHECK resource_id not empty : CHECK (((resource_id = NULL::text) OR (char_length(resource_id) > 0)))
  PRIMARY KEY sso_providers_pkey : PRIMARY KEY (id)

Indexes:
  sso_providers_pkey : CREATE UNIQUE INDEX sso_providers_pkey ON auth.sso_providers USING btree (id)
  sso_providers_resource_id_idx : CREATE UNIQUE INDEX sso_providers_resource_id_idx ON auth.sso_providers USING btree (lower(resource_id))
  sso_providers_resource_id_pattern_idx : CREATE INDEX sso_providers_resource_id_pattern_idx ON auth.sso_providers USING btree (resource_id text_pattern_ops)

Policies:
  (no policies)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| auth         | users             | -- ------------------------------------------------------------
-- DDL summary for auth.users
-- ------------------------------------------------------------

Columns:
  instance_id uuid NULL
  id uuid NOT NULL
  aud character varying(255) NULL
  role character varying(255) NULL
  email character varying(255) NULL
  encrypted_password character varying(255) NULL
  email_confirmed_at timestamp with time zone NULL
  invited_at timestamp with time zone NULL
  confirmation_token character varying(255) NULL
  confirmation_sent_at timestamp with time zone NULL
  recovery_token character varying(255) NULL
  recovery_sent_at timestamp with time zone NULL
  email_change_token_new character varying(255) NULL
  email_change character varying(255) NULL
  email_change_sent_at timestamp with time zone NULL
  last_sign_in_at timestamp with time zone NULL
  raw_app_meta_data jsonb NULL
  raw_user_meta_data jsonb NULL
  is_super_admin boolean NULL
  created_at timestamp with time zone NULL
  updated_at timestamp with time zone NULL
  phone text NULL DEFAULT NULL::character varying
  phone_confirmed_at timestamp with time zone NULL
  phone_change text NULL DEFAULT ''::character varying
  phone_change_token character varying(255) NULL DEFAULT ''::character varying
  phone_change_sent_at timestamp with time zone NULL
  confirmed_at timestamp with time zone NULL
  email_change_token_current character varying(255) NULL DEFAULT ''::character varying
  email_change_confirm_status smallint NULL DEFAULT 0
  banned_until timestamp with time zone NULL
  reauthentication_token character varying(255) NULL DEFAULT ''::character varying
  reauthentication_sent_at timestamp with time zone NULL
  is_sso_user boolean NOT NULL DEFAULT false
  deleted_at timestamp with time zone NULL
  is_anonymous boolean NOT NULL DEFAULT false

Constraints:
  CHECK users_email_change_confirm_status_check : CHECK (((email_change_confirm_status >= 0) AND (email_change_confirm_status <= 2)))
  UNIQUE users_phone_key : UNIQUE (phone)
  PRIMARY KEY users_pkey : PRIMARY KEY (id)

Indexes:
  users_pkey : CREATE UNIQUE INDEX users_pkey ON auth.users USING btree (id)
  users_instance_id_idx : CREATE INDEX users_instance_id_idx ON auth.users USING btree (instance_id)
  users_instance_id_email_idx : CREATE INDEX users_instance_id_email_idx ON auth.users USING btree (instance_id, lower((email)::text))
  confirmation_token_idx : CREATE UNIQUE INDEX confirmation_token_idx ON auth.users USING btree (confirmation_token) WHERE ((confirmation_token)::text !~ '^[0-9 ]*$'::text)
  recovery_token_idx : CREATE UNIQUE INDEX recovery_token_idx ON auth.users USING btree (recovery_token) WHERE ((recovery_token)::text !~ '^[0-9 ]*$'::text)
  email_change_token_current_idx : CREATE UNIQUE INDEX email_change_token_current_idx ON auth.users USING btree (email_change_token_current) WHERE ((email_change_token_current)::text !~ '^[0-9 ]*$'::text)
  email_change_token_new_idx : CREATE UNIQUE INDEX email_change_token_new_idx ON auth.users USING btree (email_change_token_new) WHERE ((email_change_token_new)::text !~ '^[0-9 ]*$'::text)
  reauthentication_token_idx : CREATE UNIQUE INDEX reauthentication_token_idx ON auth.users USING btree (reauthentication_token) WHERE ((reauthentication_token)::text !~ '^[0-9 ]*$'::text)
  users_email_partial_key : CREATE UNIQUE INDEX users_email_partial_key ON auth.users USING btree (email) WHERE (is_sso_user = false)
  users_phone_key : CREATE UNIQUE INDEX users_phone_key ON auth.users USING btree (phone)
  users_is_anonymous_idx : CREATE INDEX users_is_anonymous_idx ON auth.users USING btree (is_anonymous)

Policies:
  (no policies) |
| public       | businesses        | -- ------------------------------------------------------------
-- DDL summary for public.businesses
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL DEFAULT gen_random_uuid()
  business_name character varying(255) NOT NULL
  api_key character varying(255) NOT NULL
  api_url text NOT NULL
  created_at timestamp with time zone NULL DEFAULT now()
  updated_at timestamp with time zone NULL DEFAULT now()
  business_code character varying NULL
  logo_url text NULL

Constraints:
  PRIMARY KEY businesses_pkey : PRIMARY KEY (id)

Indexes:
  businesses_pkey : CREATE UNIQUE INDEX businesses_pkey ON public.businesses USING btree (id)

Policies:
  Super admins can update all businesses : roles=public qual=(EXISTS ( SELECT 1
   FROM users
  WHERE ((users.id = auth.uid()) AND ((users.role)::text = 'superadmin'::text)))) with_check=(none)
  Super admins can insert businesses : roles=public qual=(none) with_check=(EXISTS ( SELECT 1
   FROM users
  WHERE ((users.id = auth.uid()) AND ((users.role)::text = 'superadmin'::text))))
  Super admins can delete businesses : roles=public qual=(EXISTS ( SELECT 1
   FROM users
  WHERE ((users.id = auth.uid()) AND ((users.role)::text = 'superadmin'::text)))) with_check=(none)
  Users can view their business : roles=public qual=true with_check=(none)
  Allow business code validation for signup : roles=anon,authenticated qual=true with_check=(none)
  Businesses - Users can view their business : roles=public qual=(id = ( SELECT users.business_id
   FROM users
  WHERE (users.id = auth.uid()))) with_check=(none)
  Users can view their own business : roles=public qual=((id IS NOT NULL) AND ((id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| public       | controllers       | -- ------------------------------------------------------------
-- DDL summary for public.controllers
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NOT NULL
  site_id text NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY controllers_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  PRIMARY KEY controllers_pkey : PRIMARY KEY (id)
  FOREIGN KEY controllers_site_id_fkey : FOREIGN KEY (site_id) REFERENCES sites(id)

Indexes:
  controllers_pkey : CREATE UNIQUE INDEX controllers_pkey ON public.controllers USING btree (id)

Policies:
  Allow public read for controllers : roles=public qual=true with_check=(none)
  Allow public insert for controllers : roles=public qual=(none) with_check=true
  Allow public update for controllers : roles=public qual=true with_check=(none)
  Users can view controllers in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage controllers in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all controllers : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public       | departments       | -- ------------------------------------------------------------
-- DDL summary for public.departments
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY departments_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  PRIMARY KEY departments_pkey : PRIMARY KEY (id)

Indexes:
  departments_pkey : CREATE UNIQUE INDEX departments_pkey ON public.departments USING btree (id)

Policies:
  Allow authenticated read for departments : roles=authenticated qual=true with_check=(none)
  Allow public read for departments : roles=public qual=true with_check=(none)
  Allow public insert for departments : roles=public qual=(none) with_check=true
  Allow public update for departments : roles=public qual=true with_check=(none)
  Users can view departments in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage departments in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all departments : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| public       | drivers           | -- ------------------------------------------------------------
-- DDL summary for public.drivers
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NOT NULL
  first_name text NULL
  badge text NULL
  pubsn_badge text NULL
  ctrl_badge text NULL
  code text NULL
  pin_code text NULL
  department_id text NULL
  department_name text NULL
  activity_prompt boolean NULL
  nce_prompt boolean NULL
  notes text NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY drivers_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  FOREIGN KEY drivers_department_id_fkey : FOREIGN KEY (department_id) REFERENCES departments(id)
  PRIMARY KEY drivers_pkey : PRIMARY KEY (id)

Indexes:
  drivers_pkey : CREATE UNIQUE INDEX drivers_pkey ON public.drivers USING btree (id)

Policies:
  Allow authenticated read for drivers : roles=authenticated qual=true with_check=(none)
  Allow public read for drivers : roles=public qual=true with_check=(none)
  Allow public insert for drivers : roles=public qual=(none) with_check=true
  Allow public update for drivers : roles=public qual=true with_check=(none)
  Users can view drivers in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage drivers in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all drivers : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public       | fuel_transactions | -- ------------------------------------------------------------
-- DDL summary for public.fuel_transactions
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  transac_id text NULL
  date timestamp with time zone NULL
  vehicle_id text NULL
  vehicle_name text NULL
  driver_id text NULL
  driver_name text NULL
  site_id text NULL
  site_name text NULL
  volume numeric NULL
  kdelta numeric NULL
  kcons numeric NULL
  hcons numeric NULL
  manual boolean NULL
  mtr_forced boolean NULL
  vol_max boolean NULL
  new_kmeter boolean NULL
  new_hmeter boolean NULL
  has_anomalies boolean NULL
  anomalies_json jsonb NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY fuel_transactions_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  FOREIGN KEY fuel_transactions_driver_id_fkey : FOREIGN KEY (driver_id) REFERENCES drivers(id)
  PRIMARY KEY fuel_transactions_pkey : PRIMARY KEY (id)
  FOREIGN KEY fuel_transactions_vehicle_id_fkey : FOREIGN KEY (vehicle_id) REFERENCES vehicles(id)

Indexes:
  fuel_transactions_pkey : CREATE UNIQUE INDEX fuel_transactions_pkey ON public.fuel_transactions USING btree (id)

Policies:
  Allow authenticated read for fuel_transactions : roles=authenticated qual=true with_check=(none)
  Allow public read for fuel_transactions : roles=public qual=true with_check=(none)
  Allow public insert for fuel_transactions : roles=public qual=(none) with_check=true
  Allow public update for fuel_transactions : roles=public qual=true with_check=(none)
  Users can view fuel transactions in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage fuel transactions in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all fuel_transactions : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public       | products          | -- ------------------------------------------------------------
-- DDL summary for public.products
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NOT NULL
  capacity numeric NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY products_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  PRIMARY KEY products_pkey : PRIMARY KEY (id)

Indexes:
  products_pkey : CREATE UNIQUE INDEX products_pkey ON public.products USING btree (id)

Policies:
  Allow authenticated read for products : roles=authenticated qual=true with_check=(none)
  Allow public read for products : roles=public qual=true with_check=(none)
  Allow public insert for products : roles=public qual=(none) with_check=true
  Allow public update for products : roles=public qual=true with_check=(none)
  Users can view products in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage products in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all products : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| public       | pumps             | -- ------------------------------------------------------------
-- DDL summary for public.pumps
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NOT NULL
  site_id text NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY pumps_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  PRIMARY KEY pumps_pkey : PRIMARY KEY (id)
  FOREIGN KEY pumps_site_id_fkey : FOREIGN KEY (site_id) REFERENCES sites(id)

Indexes:
  pumps_pkey : CREATE UNIQUE INDEX pumps_pkey ON public.pumps USING btree (id)

Policies:
  Allow public read for pumps : roles=public qual=true with_check=(none)
  Allow public insert for pumps : roles=public qual=(none) with_check=true
  Allow public update for pumps : roles=public qual=true with_check=(none)
  Users can view pumps in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage pumps in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all pumps : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public       | sites             | -- ------------------------------------------------------------
-- DDL summary for public.sites
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NOT NULL
  code text NULL
  address text NULL
  city text NULL
  zip_code text NULL
  country text NULL
  latitude numeric NULL
  longitude numeric NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY sites_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  PRIMARY KEY sites_pkey : PRIMARY KEY (id)

Indexes:
  sites_pkey : CREATE UNIQUE INDEX sites_pkey ON public.sites USING btree (id)

Policies:
  Allow public read for sites : roles=public qual=true with_check=(none)
  Allow public insert for sites : roles=public qual=(none) with_check=true
  Allow public update for sites : roles=public qual=true with_check=(none)
  Users can view sites in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage sites in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all sites : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public       | tanks             | -- ------------------------------------------------------------
-- DDL summary for public.tanks
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NOT NULL
  volume numeric NULL
  site_id text NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY tanks_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  PRIMARY KEY tanks_pkey : PRIMARY KEY (id)
  FOREIGN KEY tanks_site_id_fkey : FOREIGN KEY (site_id) REFERENCES sites(id)

Indexes:
  tanks_pkey : CREATE UNIQUE INDEX tanks_pkey ON public.tanks USING btree (id)

Policies:
  Allow public read for tanks : roles=public qual=true with_check=(none)
  Allow public insert for tanks : roles=public qual=(none) with_check=true
  Allow public update for tanks : roles=public qual=true with_check=(none)
  Users can view tanks in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage tanks in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all tanks : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public       | users             | -- ------------------------------------------------------------
-- DDL summary for public.users
-- ------------------------------------------------------------

Columns:
  id uuid NOT NULL
  email character varying(255) NOT NULL
  full_name character varying(255) NOT NULL
  business_id uuid NULL
  created_at timestamp with time zone NULL DEFAULT now()
  updated_at timestamp with time zone NULL DEFAULT now()
  role character varying(20) NULL DEFAULT 'user'::character varying

Constraints:
  FOREIGN KEY users_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE SET NULL
  UNIQUE users_email_key : UNIQUE (email)
  PRIMARY KEY users_pkey : PRIMARY KEY (id)
  CHECK users_role_check : CHECK (((role)::text = ANY ((ARRAY['user'::character varying, 'manager'::character varying, 'admin'::character varying, 'superadmin'::character varying])::text[])))

Indexes:
  users_pkey : CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id)
  users_email_key : CREATE UNIQUE INDEX users_email_key ON public.users USING btree (email)

Policies:
  true : roles=public qual=true with_check=true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public       | vehicle_products  | -- ------------------------------------------------------------
-- DDL summary for public.vehicle_products
-- ------------------------------------------------------------

Columns:
  vehicle_id text NOT NULL
  product_id text NOT NULL
  capacity numeric NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY vehicle_products_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  PRIMARY KEY vehicle_products_pkey : PRIMARY KEY (vehicle_id, product_id)
  FOREIGN KEY vehicle_products_product_id_fkey : FOREIGN KEY (product_id) REFERENCES products(id)
  FOREIGN KEY vehicle_products_vehicle_id_fkey : FOREIGN KEY (vehicle_id) REFERENCES vehicles(id)

Indexes:
  vehicle_products_pkey : CREATE UNIQUE INDEX vehicle_products_pkey ON public.vehicle_products USING btree (vehicle_id, product_id)

Policies:
  Allow authenticated read for vehicle_products : roles=authenticated qual=true with_check=(none)
  Allow public read for vehicle_products : roles=public qual=true with_check=(none)
  Allow public insert for vehicle_products : roles=public qual=(none) with_check=true
  Allow public update for vehicle_products : roles=public qual=true with_check=(none)
  Users can view vehicle_products in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage vehicle_products in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all vehicle_products : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public       | vehicles          | -- ------------------------------------------------------------
-- DDL summary for public.vehicles
-- ------------------------------------------------------------

Columns:
  id text NOT NULL
  name text NOT NULL
  badge text NULL
  pubsn_badge text NULL
  ctrl_badge text NULL
  code text NULL
  pin_code text NULL
  model text NULL
  department_id text NULL
  department_name text NULL
  kmeter integer NULL
  hmeter numeric NULL
  notes text NULL
  business_id uuid NULL

Constraints:
  FOREIGN KEY vehicles_business_id_fkey : FOREIGN KEY (business_id) REFERENCES businesses(id) ON DELETE CASCADE
  FOREIGN KEY vehicles_department_id_fkey : FOREIGN KEY (department_id) REFERENCES departments(id)
  PRIMARY KEY vehicles_pkey : PRIMARY KEY (id)

Indexes:
  vehicles_pkey : CREATE UNIQUE INDEX vehicles_pkey ON public.vehicles USING btree (id)

Policies:
  Allow authenticated read for vehicles : roles=authenticated qual=true with_check=(none)
  Allow public read for vehicles : roles=public qual=true with_check=(none)
  Allow public insert for vehicles : roles=public qual=(none) with_check=true
  Allow public update for vehicles : roles=public qual=true with_check=(none)
  Users can view vehicles in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Users can manage vehicles in their business : roles=public qual=((business_id IS NOT NULL) AND ((business_id)::text = (auth.jwt() ->> 'business_id'::text))) with_check=(none)
  Super admins can view all vehicles : roles=public qual=(auth.uid() IN ( SELECT users.id
   FROM users
  WHERE ((users.role)::text = 'superadmin'::text))) with_check=(none)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |